import { describe, it, expect } from 'vitest';
import { registerSegments } from '../segments/registry.js';
import { decode, encode } from '../segment.js';

registerSegments();

describe('HIUPD', () => {
  it('decode and encode roundtrip matches', () => {
    const text = `HIUPD:167:6:4+1234567890::280:12030000+DE19120300001234567890+1197651234+1+EUR+KONTO INHABER 1+KONTO INHABER 2+Sichteinlagen++HKSAK:1+HKISA:1+HKSSP:1+HKPAE:1+HKTAB:1+HKTAZ:1+HKTML:1+HKSPA:1+HKCAZ:1+HKCCM:1+HKCCS:1+HKCDB:1+HKCDE:1+HKCDL:1+HKCDN:1+HKCDU:1+HKCMB:1+HKCME:1+HKCML:1+HKCSA:1+HKCSB:1+HKCSE:1+HKCSL:1+HKDSB:1+HKDSW:1+HKEKA:1+DKPSA:1+DKPSP:1+HKTAN:1+DKANA:1+DKANL:1+DKKBA:1+DKSID:1+DKBAZ:1+DKZDF:1+DKZDL:1+HKFRD:1+HKAUB:1+HKKAZ:1+HKKIF:1+HKSAL:1+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++{"umsltzt"?:"2024-01-20-14.50.31.849705"}'`;
    const segment = decode(text);
    expect(encode(segment)).toBe(text);
  });
});
